{"version":3,"file":"CleanUserpage.min.js","mappings":"mBAAA,IAAMA,EAAkBC,GAAGC,OAAOC,IAAI,qBAChCC,EAAYH,GAAGC,OAAOC,IAAI,WAC1BE,EAAWJ,GAAGC,OAAOC,IAAI,cACzBG,EAAWL,GAAGC,OAAOC,IAAI,cAE/B,GAAwB,IAApBH,IACCI,EAAUG,WAAWD,EAAW,MAAQF,IAAcE,GAAW,CAClEE,EAAEP,GAAGQ,KAAKC,eAAe,aAAc,IAAK,OAAQ,iBAAkB,OAAQ,MAAMC,GAAG,QAAS,SAAUC,GACtGA,EAAEC,iBAEF,IAAIC,EAAS,IAAIC,GAAGC,GAAGC,cAEnBC,EAAgB,IAAIH,GAAGC,GAAGG,cAC9BX,EAAE,QAAQY,OAAOF,EAAcG,UAC/BH,EAAcI,WAAW,CAACR,IAE1BI,EAAcK,WAAWT,EAAQ,CAC7BU,MAAO,SACPC,QAAS,eACTC,QAAS,CACL,CACIC,OAAQ,UACRC,MAAO,KACPC,MAAO,CAAC,UAAW,gBAEvB,CACIF,OAAQ,SACRC,MAAO,KACPC,MAAO,WAGhBC,OAAOC,KAAK,SAAUC,GACjBA,GAAwB,YAAhBA,EAAKL,SASrB,IAAI1B,GAAGgC,KAAMC,cAAc,OAAQ,CAC/BC,OAAQ,OACRR,OAAQ,OACRS,UAAW,WACXC,KAAM,kBACNb,MAAOnB,EACPiC,KAAM,GACNC,QAAS,SAEZC,KAAK,WACFvC,GAAGwC,OAAO,cAAe,CAAEC,KAAM,YACjCC,WAAW,WACPC,SAASC,QACb,EAAG,IACP,GACCC,KAAK,SAAUC,GACZ,IAAIC,EAAWD,EAAIE,MAAQF,EAAIE,MAAMC,KAAOH,EAC5C9C,GAAGwC,OAAO,aAAeO,EAAU,CAAEN,KAAM,SAC/C,GAvBIxB,EAAciC,SAClB,EACJ,EAuBJ,C","sources":["webpack://mwgadgets/./src/CleanUserpage/index.js"],"sourcesContent":["const namespaceNumber = mw.config.get(\"wgNamespaceNumber\");\nconst pageTitle = mw.config.get(\"wgTitle\");\nconst pageName = mw.config.get(\"wgPageName\");\nconst userName = mw.config.get(\"wgUserName\");\n\nif (namespaceNumber === 2 && \n    (pageTitle.startsWith(userName + \"/\") || pageTitle === userName)) {\n    $(mw.util.addPortletLink(\"p-cactions\", \"#\", \"清空页面\", \"clear-userpage\", \"清空页面\", \"r\")).on(\"click\", function (e) {\n        e.preventDefault();\n\n        var dialog = new OO.ui.MessageDialog();\n        \n        var windowManager = new OO.ui.WindowManager();\n        $('body').append(windowManager.$element);\n        windowManager.addWindows([dialog]);\n\n        windowManager.openWindow(dialog, {\n            title: \"确认清空页面\",\n            message: \"您确定要清空当前页面吗？\",\n            actions: [\n                {\n                    action: \"confirm\",\n                    label: \"确认\",\n                    flags: ['primary', 'destructive']\n                },\n                {\n                    action: \"cancel\",\n                    label: \"取消\",\n                    flags: \"safe\"\n                }\n            ]\n        }).closed.then(function (data) {\n            if (data && data.action === \"confirm\") {\n                clearUserPage();\n            }\n            \n            windowManager.destroy();\n        });\n    });\n    \n    function clearUserPage() {\n        new mw.Api().postWithToken(\"csrf\", {\n            format: \"json\",\n            action: \"edit\",\n            watchlist: \"nochange\",\n            tags: \"Automation tool\",\n            title: pageName,\n            text: \"\",\n            summary: \"清空页面\"\n        })\n        .done(function () {\n            mw.notify(\"清空完毕，即将刷新……\", { type: \"success\" });\n            setTimeout(function () {\n                location.reload();\n            }, 2000);\n        })\n        .fail(function (err) {\n            var errorMsg = err.error ? err.error.info : err;\n            mw.notify(\"清空页面时出现错误：\" + errorMsg, { type: \"error\" });\n        });\n    }\n}"],"names":["namespaceNumber","mw","config","get","pageTitle","pageName","userName","startsWith","$","util","addPortletLink","on","e","preventDefault","dialog","OO","ui","MessageDialog","windowManager","WindowManager","append","$element","addWindows","openWindow","title","message","actions","action","label","flags","closed","then","data","Api","postWithToken","format","watchlist","tags","text","summary","done","notify","type","setTimeout","location","reload","fail","err","errorMsg","error","info","destroy"],"sourceRoot":""}