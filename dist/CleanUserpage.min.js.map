{"version":3,"file":"CleanUserpage.min.js","mappings":"mBAAA,IAAMA,EAAkBC,GAAGC,OAAOC,IAAI,qBAChCC,EAAYH,GAAGC,OAAOC,IAAI,WAC1BE,EAAWJ,GAAGC,OAAOC,IAAI,cACzBG,EAAWL,GAAGC,OAAOC,IAAI,cAE/B,GAAwB,IAApBH,IACCI,EAAUG,WAAWD,EAAW,MAAQF,IAAcE,GAAW,CAClEE,EAAEP,GAAGQ,KAAKC,eAAe,aAAc,IAAK,OAAQ,iBAAkB,OAAQ,MAAMC,GAAG,QAAS,SAAUC,GACtGA,EAAEC,iBAEF,IAAIC,EAAS,IAAIC,GAAGC,GAAGC,cAEnBC,EAAgB,IAAIH,GAAGC,GAAGG,cAC9BX,EAAE,QAAQY,OAAOF,EAAcG,UAC/BH,EAAcI,WAAW,CAACR,IAE1BI,EAAcK,WAAWT,EAAQ,CAC7BU,MAAO,SACPC,QAAS,eACTC,QAAS,CACL,CACIC,OAAQ,UACRC,MAAO,KACPC,MAAO,CAAC,UAAW,gBAEvB,CACIF,OAAQ,SACRC,MAAO,KACPC,MAAO,WAGhBC,OAAOC,KAAK,SAAUC,GACjBA,GAAwB,YAAhBA,EAAKL,SASrB,IAAI1B,GAAGgC,KAAMC,cAAc,OAAQ,CAC/BC,OAAQ,OACRR,OAAQ,OACRS,UAAW,WACXC,KAAM,kBACNb,MAAOnB,EACPiC,KAAM,GACNC,QAAS,SAEZC,KAAK,WACFvC,GAAGwC,OAAO,cAAe,CAAEC,KAAM,YACjCC,WAAW,WACPC,SAASC,QACb,EAAG,IACP,GACCC,KAAK,SAAUC,GACZ,IAAIC,EAAWD,EAAIE,MAAQF,EAAIE,MAAMC,KAAOH,EAC5C9C,GAAGwC,OAAO,aAAeO,EAAU,CAAEN,KAAM,SAC/C,GAvBIxB,EAAciC,SAClB,EACJ,EAuBJ,C","sources":["webpack://mwgadgets/./src/CleanUserpage/index.js"],"sourcesContent":["const namespaceNumber = mw.config.get(\"wgNamespaceNumber\");\r\nconst pageTitle = mw.config.get(\"wgTitle\");\r\nconst pageName = mw.config.get(\"wgPageName\");\r\nconst userName = mw.config.get(\"wgUserName\");\r\n\r\nif (namespaceNumber === 2 && \r\n    (pageTitle.startsWith(userName + \"/\") || pageTitle === userName)) {\r\n    $(mw.util.addPortletLink(\"p-cactions\", \"#\", \"清空页面\", \"clear-userpage\", \"清空页面\", \"r\")).on(\"click\", function (e) {\r\n        e.preventDefault();\r\n\r\n        var dialog = new OO.ui.MessageDialog();\r\n        \r\n        var windowManager = new OO.ui.WindowManager();\r\n        $('body').append(windowManager.$element);\r\n        windowManager.addWindows([dialog]);\r\n\r\n        windowManager.openWindow(dialog, {\r\n            title: '确认清空页面',\r\n            message: '您确定要清空当前页面吗？',\r\n            actions: [\r\n                {\r\n                    action: 'confirm',\r\n                    label: '确认',\r\n                    flags: ['primary', 'destructive']\r\n                },\r\n                {\r\n                    action: 'cancel',\r\n                    label: '取消',\r\n                    flags: 'safe'\r\n                }\r\n            ]\r\n        }).closed.then(function (data) {\r\n            if (data && data.action === 'confirm') {\r\n                clearUserPage();\r\n            }\r\n            \r\n            windowManager.destroy();\r\n        });\r\n    });\r\n    \r\n    function clearUserPage() {\r\n        new mw.Api().postWithToken(\"csrf\", {\r\n            format: \"json\",\r\n            action: \"edit\",\r\n            watchlist: \"nochange\",\r\n            tags: \"Automation tool\",\r\n            title: pageName,\r\n            text: \"\",\r\n            summary: \"清空页面\"\r\n        })\r\n        .done(function () {\r\n            mw.notify(\"清空完毕，即将刷新……\", { type: 'success' });\r\n            setTimeout(function () {\r\n                location.reload();\r\n            }, 2000);\r\n        })\r\n        .fail(function (err) {\r\n            var errorMsg = err.error ? err.error.info : err;\r\n            mw.notify(\"清空页面时出现错误：\" + errorMsg, { type: 'error' });\r\n        });\r\n    }\r\n}"],"names":["namespaceNumber","mw","config","get","pageTitle","pageName","userName","startsWith","$","util","addPortletLink","on","e","preventDefault","dialog","OO","ui","MessageDialog","windowManager","WindowManager","append","$element","addWindows","openWindow","title","message","actions","action","label","flags","closed","then","data","Api","postWithToken","format","watchlist","tags","text","summary","done","notify","type","setTimeout","location","reload","fail","err","errorMsg","error","info","destroy"],"sourceRoot":""}