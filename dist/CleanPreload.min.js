$(function(){if(0===mw.config.get("wgNamespaceNumber")&&(0!==mw.config.get("wgRevisionId")||0!==mw.config.get("wgArticleId"))){var t=mw.util.addPortletLink("p-cactions","#","清理预加载","clear-preload","清理预加载","l");$(t).on("click",function(t){t.preventDefault();var e=mw.config.get("wgPageName"),o=new mw.Api;o.get({action:"query",titles:e,prop:"revisions",rvprop:"content",formatversion:"2"}).then(function(t){if(!t.query||!t.query.pages||0===t.query.pages.length)throw new Error("无法获取页面数据");var n=t.query.pages[0];if(n.missing)throw new Error("页面不存在");var i=n.revisions[0].content,r=i.replace(/<!--[\s\S]*?-->/g,"");if(i!==r)return o.postWithToken("csrf",{action:"edit",title:e,text:r,summary:"[[User:SaoMikoto/js#快速移除预加载模板|移除预加载模板]]",tags:"Automation tool",watchlist:"nochange"});mw.notify("未找到需要清理的预加载内容")}).then(function(){mw.notify("清理完成，即将刷新页面..."),setTimeout(function(){location.reload()},2e3)}).catch(function(t){mw.notify("操作失败: "+t),console.error("清理预加载出错：",t)})})}});
//# sourceMappingURL=CleanPreload.min.js.map