(()=>{"use strict";function e(){var n,o,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function s(e,r,i,a){var s=r&&r.prototype instanceof l?r:l,u=Object.create(s.prototype);return t(u,"_invoke",function(e,t,r){var i,a,s,l=0,u=r||[],p=!1,d={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return i=e,a=0,s=n,d.n=t,c}};function m(e,t){for(a=e,s=t,o=0;!p&&l&&!r&&o<u.length;o++){var r,i=u[o],m=d.p,f=i[2];e>3?(r=f===t)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=m&&((r=e<2&&m<i[1])?(a=0,d.v=t,d.n=i[1]):m<f&&(r=e<3||i[0]>t||t>f)&&(i[4]=e,i[5]=t,d.n=f,a=0))}if(r||e>1)return c;throw p=!0,t}return function(r,u,f){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&m(u,f),a=u,s=f;(o=a<2?n:s)||!p;){i||(a?a<3?(a>1&&(d.n=-1),m(a,s)):d.n=s:d.v=s);try{if(l=2,i){if(a||(r="next"),o=i[r]){if(!(o=o.call(i,s)))throw TypeError("iterator result is not an object");if(!o.done)return o;s=o.value,a<2&&(a=0)}else 1===a&&(o=i.return)&&o.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=n}else if((o=(p=d.n<0)?s:e.call(t,d))!==c)break}catch(e){i=n,a=1,s=e}finally{l=1}}return{value:o,done:p}}}(e,i,a),!0),u}var c={};function l(){}function u(){}function p(){}o=Object.getPrototypeOf;var d=[][i]?o(o([][i]())):(t(o={},i,function(){return this}),o),m=p.prototype=l.prototype=Object.create(d);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=p,t(m,"constructor",p),t(p,"constructor",u),u.displayName="GeneratorFunction",t(p,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,i,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:f}})()}function t(e,n,o,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,o,r){function a(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?i?i(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o:(a("next",0),a("throw",1),a("return",2))},t(e,n,o,r)}function n(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise(function(r,i){var a=e.apply(t,o);function s(e){n(a,r,i,s,c,"next",e)}function c(e){n(a,r,i,s,c,"throw",e)}s(void 0)})}}mw.loader.using(["mediawiki.api","mediawiki.Title","ext.gadget.libOOUIDialog"],function(){var t=mw.config.get(["wgNamespaceNumber","wgTitle","wgUserGroups","skin","wgUserName"]),n={"zh.moegirl.org.cn":{t:"即将删除",s:"[[User:星海子/Gadgets#批量挂删页面|批量挂删]]："},"mzh.moegirl.org.cn":{t:"即将删除",s:"[[User:星海子/Gadgets#批量挂删页面|批量挂删]]："},"commons.moegirl.org.cn":{t:"即将删除",s:"[[zh:User:星海子/Gadgets#批量挂删页面|批量挂删]]："},"en.moegirl.org.cn":{t:"Awaiting deletion",s:"[[zh:User:星海子/Gadgets#批量挂删页面|Batch Flag for Deletion]]："},"ja.moegirl.org.cn":{t:"Sakujo",s:"[[zh:User:星海子/Gadgets#批量挂删页面|複数のページを一括削除]]："},"library.moegirl.org.cn":{t:"即将删除",s:"[[zh:User:星海子/Gadgets#批量挂删页面|批量挂删]]："}};function r(){document.getElementById("wpMassDeleteSubmit").disabled=!0;var e=document.getElementById("wpMassDeletePages").value.split("\n");if(e=function(e){var t,n,o=[];for(t=0,n=e.length;t<n;t++){var r=e[t];(r=r.trim())&&o.push(r)}return o}(e),e.length){for(var o=0,r=new mw.Api,i=document.getElementById("wpMassDeleteReason").value,a=document.getElementById("wpMassDeleteWatch").value,s=[],c=[],l=function(){o++,document.getElementById("wpMassDeleteSubmit").value="(".concat(o,")")},u=m(e[0])(),p=1,d=e.length;p<d;p++)u=u.then(m(e[p]));$.when(u).then(function(){if(document.getElementById("wpMassDeleteSubmit").value="已完成 ".concat(o," 个挂删"),s.length){for(var e=$("<ul>"),t=0;t<s.length;t++){var n=mw.Title.newFromText(s[t]),r=$("<li>");n?r.append($("<a>").attr("href",n.getUrl()).text(s[t])):r.text(s[t]),r.append(document.createTextNode(": ".concat(c[t]))),e.append(r)}$("#wpMassDeleteFailedContainer").append($("<br />")).append($("<b>").text("挂删失败：")).append(e)}})}function m(e){return function(){return $.Deferred(function(o){e.startsWith("cm:")&&(e=e.substring(3));var u={format:"json",action:"edit",watchlist:a,title:e,text:"<noinclude>{{".concat(n[location.hostname].t,"|1=").concat(i,"|user=").concat(t.wgUserName,"}}</noinclude>"),summary:n[location.hostname].s+i,tags:"Automation tool",nocreate:!0,bot:t.wgUserGroups.includes("flood")},p=r.postWithToken("csrf",u);p.done(l),p.fail(function(t,n){s.push(e),c.push(n.error.info)}),p.always(function(){o.resolve()})})}}}function i(){var n="moeskin"===t.skin?"moe-body-content":"bodyContent";document.getElementsByTagName("h1")[0].textContent="Special:批量挂删页面",document.title="批量挂删页面 - 萌娘百科 万物皆可萌的百科全书",document.getElementById(n).innerHTML='<p>大量挂删页面之工具，请慎用！</p><form id="wpMassDelete" name="wpMassDelete"><p>如有滥用之行为，后果请阁下自行承担。</p><p><b>使用方法</b></p><p>1.在挂删列表填写页面，每行一个页面，不需要加[[]]；</p><p>2.添加挂删原因，自行填写或选择预置项均可；</p><p>3.确认无误后点击确认提交；</p><p>4.页面将逐个挂删，按钮的数字将从0增加，请勿关闭本页面;</p><p>5.完成后，按钮文字会显示为完成数量。</p><div id="wpMassDeleteFailedContainer"></div><hr /><br /><b>挂删列表</b>：<br /><textarea tabindex="1" accesskey="," name="wpMassDeletePages" id="wpMassDeletePages" rows="10" cols="80"></textarea><br /><table style="background-color:transparent"><tr><td>监视页面</td><td><select id="wpMassDeleteWatch"><option value="preferences">与参数设置同步</option><option value="nochange">不更改</option><option value="watch">加入监视列表</option><option value="unwatch">取消监视</option></select></td></tr><tr><td>挂删原因：</td><td><input type="text" style="width:30em;height:1.5em" id="wpMassDeleteReason" list="MassDeleteReasonList" name="wpMassDeleteReason" maxlength="255" /></td><datalist id="MassDeleteReasonList"><option>内容极少/质量极差</option><option>用户本人申请</option><option>错误命名</option><option>移动残留重定向</option><option>无法修复的受损重定向/双重重定向</option><option>不再使用的文件</option><option>文件替换申请</option><option>重复或有更佳版本的文件</option><option>用户页开设维基农场</option><option>违反法律法规或内容管理方针</option></datalist></tr><tr><td><input type="button" id="wpMassDeleteSubmit" name="wpMassDeleteSubmit" value="确认" /></td></form>',document.getElementById("wpMassDeleteSubmit").addEventListener("click",o(e().m(function t(){return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,oouiDialog.confirm("请确认您的挂删信息是否填写正确！",{title:"MassTool",size:"small"});case 1:e.v&&r();case 2:return e.a(2)}},t)})))}function a(){return(a=o(e().m(function n(){return e().w(function(e){for(;;)switch(e.n){case 0:if(t.wgUserGroups.includes("patroller")||t.wgUserGroups.includes("sysop")){e.n=2;break}return e.n=1,oouiDialog.alert("您不是维护人员，禁止使用批量挂删工具！",{title:"MassTool",size:"small"});case 1:return e.a(2,e.v);case 2:i();case 3:return e.a(2)}},n)}))).apply(this,arguments)}-1!==t.wgNamespaceNumber||"massdelete"!==t.wgTitle.toLowerCase()&&"md"!==t.wgTitle.toLowerCase()||function(){a.apply(this,arguments)}(),window.MassDelete&&mw.util.addPortletLink("p-tb","/Special:MassDelete","批量挂删","t-massdelete")})})();
//# sourceMappingURL=MassFlageDelete.min.js.map