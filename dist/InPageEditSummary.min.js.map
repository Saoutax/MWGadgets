{"version":3,"file":"InPageEditSummary.min.js","mappings":"mBAAAA,GAAGC,KAAK,cAAcC,IAEtB,WACqB,IAAIC,iBAAiB,WAClC,IAAMC,EAASC,EAAE,4BACXC,EAASD,EAAE,gBAEbD,EAAOG,QAAUD,EAAOC,SAAWH,EAAOI,KAAK,cAAcD,QAWzE,SAAoBH,EAAQE,GACxB,IAAMG,EAAOJ,EAAE,QAAS,CAAEK,GAAI,YAAaC,KAAM,UAGjD,GAFAP,EAAOQ,MAAMH,IAERI,MAAMC,QAAQC,YACf,OAGJA,WAAWC,QAAQ,SAACC,EAAMC,GACtB,IAAMC,EAA8B,iBAATF,EACrB,CAAEG,QAASH,EAAMI,MAAOJ,GACxB,CAAEG,QAASH,EAAKG,SAAWH,EAAKI,OAAS,GAAIA,MAAOJ,EAAKI,OAASJ,EAAKG,SAAW,IAElFE,EAAOjB,EAAE,MAAO,CAClBkB,KAAM,IACNZ,KAAMQ,EAAYE,MAClBG,MAAOL,EAAYC,UACpBK,GAAG,QAAS,SAAAC,GACXA,EAAEC,iBACFrB,EAAOsB,IAQnB,SAAuBC,EAASlB,GAC5B,IAAMmB,EAAUD,EAAQE,MAAM,iBAC9B,GAAID,EAAS,CACT,IAAME,EAAMF,EAAQG,MAAQH,EAAQ,GAAGvB,OACvC,MAAO,GAAP2B,OAAUL,EAAQM,MAAM,EAAGH,GAAI,KAAAE,OAAIvB,GAAIuB,OAAGL,EAAQM,MAAMH,GAC5D,CAEA,IAAMI,EAASP,EAAQQ,QAAQ,MAC/B,IAAgB,IAAZD,EACA,MAAO,GAAPF,OAAUL,EAAQM,MAAM,EAAGC,GAAQE,QAAQ,OAAQ,MAAIJ,OAAGvB,EAAI,KAAAuB,OAAIL,EAAQM,MAAMC,IAGpF,OAAOP,IAAY,MAAMU,KAAKV,GAAW,GAAHK,OAAML,EAAO,KAAAK,OAAIvB,GAAI,GAAAuB,OAAQL,GAAW,IAAEK,OAAGvB,EACvF,CArBuB6B,CAAclC,EAAOsB,OAAS,GAAIT,EAAYC,UAAUqB,OACvE,GAEAhC,EAAKiC,OAAOpB,GACRJ,EAAIH,WAAWR,OAAS,GAAGE,EAAKiC,OAAO,MAC/C,EACJ,CAnCYC,CAAWvC,EAAQE,EAE3B,GAESsC,QAAQC,SAASC,KAAM,CAC5BC,WAAW,EACXC,SAAS,GAEjB,GA4CAC,OAAOlC,WAAakC,OAAOlC,YAAc,CACrC,OACA,OACA,OACA,KACA,OACA,KACA,MACA,M","sources":["webpack://mwgadgets/./src/InPageEditSummary/index.js"],"sourcesContent":["mw.hook(\"InPageEdit\").add(IPEQuickSummary);\n\nfunction IPEQuickSummary() {\n    const observer = new MutationObserver(() => {\n        const $label = $(\"label[for='editSummary']\");\n        const $input = $(\"#editSummary\");\n\n        if ($label.length && $input.length && !$label.next(\"#mysummary\").length) {\n            summaryBox($label, $input);\n        }\n    });\n\n    observer.observe(document.body, {\n        childList: true,\n        subtree: true\n    });\n}\n\nfunction summaryBox($label, $input) {\n    const $box = $(\"<div>\", { id: \"mysummary\", text: \"快速摘要：\" });\n    $label.after($box);\n\n    if (!Array.isArray(IPESummary)) {\n        return;\n    }\n\n    IPESummary.forEach((item, i) => {\n        const summaryItem = typeof item === \"string\" \n            ? { summary: item, label: item } \n            : { summary: item.summary || item.label || \"\", label: item.label || item.summary || \"\" };\n\n        const $btn = $(\"<a>\", {\n            href: \"#\",\n            text: summaryItem.label,\n            title: summaryItem.summary\n        }).on(\"click\", e => {\n            e.preventDefault();\n            $input.val(insertSummary($input.val() || \"\", summaryItem.summary)).focus();\n        });\n\n        $box.append($btn);\n        if (i < IPESummary.length - 1) $box.append(\" | \");\n    });\n}\n\nfunction insertSummary(current, text) {\n    const section = current.match(/(\\/\\*.*?\\*\\/)/);\n    if (section) {\n        const pos = section.index + section[0].length;\n        return `${current.slice(0, pos)} ${text}${current.slice(pos)}`;\n    }\n\n    const viaIPE = current.indexOf(\"//\");\n    if (viaIPE !== -1) {\n        return `${current.slice(0, viaIPE).replace(/\\s*$/, \" \")}${text} ${current.slice(viaIPE)}`;\n    }\n\n    return current && !/\\s$/.test(current) ? `${current} ${text}` : `${current || \"\"}${text}`;\n}\n\nwindow.IPESummary = window.IPESummary || [\n    '修饰语句',\n    '修正笔误',\n    '内容扩充',\n    '排版',\n    '内部链接',\n    '分类',\n    '消歧义',\n    '萌百化',\n  ];"],"names":["mw","hook","add","MutationObserver","$label","$","$input","length","next","$box","id","text","after","Array","isArray","IPESummary","forEach","item","i","summaryItem","summary","label","$btn","href","title","on","e","preventDefault","val","current","section","match","pos","index","concat","slice","viaIPE","indexOf","replace","test","insertSummary","focus","append","summaryBox","observe","document","body","childList","subtree","window"],"sourceRoot":""}